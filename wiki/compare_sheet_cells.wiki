#summary compare two sheets of excel workbook
#labels Phase-Requirements,Phase-Design,Phase-Deploy

<wiki:toc max_depth="3" />

= Introduction =

 * compare two sheets of excel workbook

== 概要 ==
 * エクセルで２つのシートを比較する

= Details =

== 説明 ==
 * ブックを開くと、操作用のボタンがツールバー（リボン）に追加される。
    * 編集シート、参照シート、比較、比較結果、≏値、≏式、着色、差分
 * ツールバーの機能
    * `編集シート` ボタンを押すと現在のシートを編集用（２次）シートとして記憶する。
    * `参照シート` ボタンを押すと現在のシートを参照用（１次）シートとして記憶する。
    * `比較` ボタンを押すとシート全体の比較を行う。
      * 比較結果のサマリーをツールバーに表示する。
    * 比較により一致しないセルの位置がリストに入っており、選択により該当セルに移動する。
    * `≏値` ボタンで、セル値による比較の有無を切り替える。
      * 初期値は、オン。
    * `≏式` ボタンで、セル数式による比較の有無を切り替える。
      * 初期値は、オフ。
    * `着色` ボタンで、不一致セルへの着色の有無を切り替える。
      * 編集シートの不一致セルを着色する。(赤色)
      * 編集シートの使用済み列の右隣に、不一致セルのある行を着色する。(黄色)
      * ワークシートの右端いっぱいまで使用済みの場合、行への着色は行わない。
      * 編集シートのセル背景色は、比較開始時にすべて消去される。
      * 初期値は、着色する。
    * `差分` ボタンで、不一致セル情報を抜き出した差分シート作成の有無を切り替える。
      * 出力される情報
        * 不一致セルのアドレス、編集側の値、参照側の値
      * 初期値は、出力する。

= Downloads =

 * [http://code.google.com/p/cowares-excel-hello/downloads/list?can=2&q=compare_sheet_cells downloads / ダウンロード]

= How to use =


== 使い方 ==

 * 用途
    # ２つのワークシートで、内容が一致しないセルを探す。
    # セルが一致する条件は、値、式、あるいはその両方、といったように、設定する。
    # 通常ブックとアドインの両形式が利用できる。アドイン名称は、`エクセル比較 甲子`。

 # 不一致セルの検索
    # ツールバーの `編集シート` ボタンを押すと現在のシートを編集用（２次）シートとして記憶する。
    # ツールバーの `参照シート` ボタンを押すと現在のシートを参照用（１次）シートとして記憶する。
    # ツールバーの `比較` ボタンを押すと、２つのシートを比較し、ボタンの右側の結果表示枠に結果を表示する。
      * すべて一致している場合、 `○` が表示される。
      * 一致しないセルがあれば、その数が表示される。
      * 一致しないセルのリストが、数の下に並び、選んだセルにジャンプする。
    # ツールバーの `≏値` ボタンがオンの場合、値の一致をセル一致の必要条件とする。
      * セルの計算結果 (.Value) を比較する。
      * 異なる計算式でも、固定値との混在でも、計算結果が一致すれば値の一致とする。
      * 計算エラーの場合、同種のエラーなら値の一致とする。
    # ツールバーの `≏式` ボタンがオンの場合、数式の一致をセル一致の必要条件とする。
      * セルの計算式 (`.FormulaR1C1`) を比較する。
      * 計算式でなく固定値がセルに入力されている場合、セル値 (.Value) を用いる。
      * 一方が固定値で他方が計算式の場合は、常に数式の不一致とする。
    # ツールバーの `着色` ボタンがオンの場合、編集用シートに不一致セルを着色して記録する。
    # ツールバーの `差分` ボタンがオンの場合、差分を抜き出したシートを新たに作成する。
 # セルの一致条件を切り替える
    # 値オンの場合、計算値が一致しないセルが抽出される。
      * 初期値は、値のみオンで、計算値の比較。
    # 式オンの場合、数式が一致しないセルが抽出される。
    # 値と式の両方をオンにした場合、数式とその計算値の両方が一致するセル以外が抽出される。
 # 制約など
    * 違いが大きすぎるシートを比較した場合には、エクセルの仕様上の制限などにより、動作に制約を受けることがある。また、制限を越えた処理を可能にしている場合でも、制限に近いレベルではエクセルの使用するメモリ等資源が膨大になるため、動作が遅くなったり、エクセルが不安定になることもある。
    * 既知の事項
      # エクセルの仕様により、エクセル2007以前では8,192を超える不連続なセル範囲を同時に扱えない。
        * 不一致セルの不連続領域が8,192を超えた場合に問題となる。
        *  `AreaBuilder` を導入し、この制限を越えた処理を可能にしている。
        * エクセル2010では上限値がこれより大きいが、8,192程度の不連続領域を扱うと動作が非常に遅くなることに違いはない。
      # エクセルの仕様により、セルのアドレスを文字として扱う場合、255字を超えるものは扱えない。
        * 不一致セルのアドレスを表記する際に問題となる。
        *  `AreaBuilder` を導入し、この制限を越えた処理を可能にしている。
      # エクセルの仕様により、１つのセルに格納できる最長の文字列は、32,767字。
        * 不一致セルのアドレスを表記する際に問題となる。
        * 差分シートに記載する差分セルのアドレス長が32,767字を超える場合、隣接するセルに分割して格納する。
      # エクセルの仕様により、エクセル2007以上では、ツールバーのリストに1,000個を超えるデータを格納できない。
        * 不一致セルの総数が1,000個以上になった場合、先頭999個までの不一致セルだけがツールバーに格納される。
        * エクセル2000など、ツールバーの動作に上記制限が無いバージョンでは、この問題は発生しない。
    * 未知の事項
      * エクセルには明確に公開されていない仕様上の制約が多数あるため、他にも潜在的な問題が潜んでいる可能性はある。
      * 制約の上限値が、搭載メモリ量に依存しているケースもある。
      * 多くの場合、制約にかかるほど多くの不一致セルがある場合には、差分作成に時間がかかり、その間、エクセルが応答しない状態になる。この状況は搭載メモリ量などに依存する。


= Snapshots =



= Code =

{{{

}}}
