#summary compare two sheets of excel workbook with a verifiable form
#labels Phase-Requirements,Phase-Design,Phase-Deploy

<wiki:toc max_depth="3" />

= Introduction =

 * compare two sheets of excel workbook with a verifiable form

== 概要 ==
 * エクセルで２つのシートを比較し、フォームで確認しながら修正する

= Details =

== 説明 ==
 * ブックを開くと、操作用のボタンがツールバー（リボン）に追加される。
    * 参照シート、編集シート、比較、比較結果、入力、解除
 * ツールバーの機能
    * `参照シート` ボタンを押すと現在のシートを参照用（１次）シートとして記憶する。
    * `編集シート` ボタンを押すと現在のシートを編集用（２次）シートとして記憶する。
    * `比較` ボタンを押すとシート全体の比較を行う。
      * 比較結果のサマリーをツールバーに表示する。
      * セルへの着色等は行わない。
    * 比較により一致しないセルの位置がリストに入っており、選択により該当セルに移動し、入力フォームを開く。
    * `入力` ボタンを押すと、現在のセルで入力フォームを開く。
      * 該当セルが参照用であれば、対応する編集用のセルで開く。
      * 該当セルが編集用でも参照用でも無ければ、編集シート設定を変更し、比較結果をクリアする。
      * 隠したフォームの再表示も、このボタンを押す。
      * このボタンに F3 キーのショートカットを割り当てる。
    * `解除` ボタンを押すと、参照シートと編集シートの指定を解除し、比較結果をクリアする。
      * 開いているフォームがあれば、閉じる。
 * 入力フォームの概要
    * 左右に２つのテキスト枠が並ぶ。
      * 左側が編集用。右側が参照用。
    * 上部に、操作ボタンが並ぶ。
      * 比較(&C)、保存(&W)、次(&A)、↓(&X)、↑(&E)、←(&S)、→(&D)、閉じる(&Q)、隠す(&Z)
 * 入力フォームの機能
    * 比較機能
      * 参照用テキスト枠は読み取り専用で色により違う個所を示す。
      * 編集用と一致しない場合、枠全体の背景が黄色になる。
      * 編集用と異なる最初の文字以降が赤字になる。
      * 入力カーソルは一致しない最初の文字に移動する。
    * 左側テキスト枠でテキスト修正を行った後、次の操作のいずれかにより再度比較を行う。
      * `保存` ボタン。
      * `比較` ボタン。
      * `Alt-C` 操作（比較ボタンのショートカット）。
    * セル移動機能。
      * `次` ボタンにより、比較結果の一致しないセルへ順次移動する。
      * 矢印ボタンにより、隣のセルに移動する。
      * 未保存の修正がある状態で閉じるや移動を試みると、警告を出す。
      * セル移動により、編集用シートのカーソル位置は連動する。
    * フォームは親のエクセルと同じサイズで開き、その後はサイズ固定。
    * モードレスフォームなので、開いたままで操作できる。
    * フォームを開いたとき、セル移動操作を行ったときに自動実行される機能
      * フォーカスは左側テキスト枠に移る。
      * 比較が行われる。
    * 編集テキスト枠で使えるショートカット
      * Ctrl-C, Ctrl-X, Ctrl-V, Ctrl-A が通常どおり使用できる。

= Downloads =

 * [http://code.google.com/p/cowares-excel-hello/downloads/list?can=2&q=compare_sheet_form downloads / ダウンロード]

= How to use =


== 使い方 ==

 * 用途
    # フォームでセルの長文を編集する。
    # ２つのワークシートで、内容が一致しないセルを探す。
    # 参照用シートと編集用シートの、対応するセルをフォームで比べながら、長文を編集する。
    
 # フォームでの編集
    # ツールバーの `入力` ボタンを押すと、現在のセルをフォームで編集する。
    # `F3` キーを、 `入力` ボタンのショートカットとして使用できる。
 # 不一致セルの検索
    # ツールバーの `参照シート` ボタンを押すと現在のシートを参照用（１次）シートとして記憶する。
    # ツールバーの `編集シート` ボタンを押すと現在のシートを編集用（２次）シートとして記憶する。
    # ツールバーの `比較` ボタンを押すと、２つのシートを比較し、ボタンの右側の結果表示枠に結果を表示する。
      * すべて一致している場合、 `○` が表示される。
      * 一致しないセルがあれば、その数が表示される。
      * 一致しないセルのリストが、数の下に並び、選んだセルにジャンプし、フォームで編集できる。
 # 比較しながら編集
    # 参照シートと編集シートが設定された状態でフォームを開くと、対応するセルの内容を並べて表示し、比較編集ができる。
    # 比較した結果に応じて、参照側の色が変化する。
      * 参照セルと編集セルの内容が一致すれば、白地に黒文字。
      * 一致しないとき、背景が黄色になる。
      * 一致しない最初の文字以降が赤文字になる。
 # フォームの操作
    # `比較` ボタンは、編集中のテキスト（保存前）と参照セルを比較し、その結果に応じて色を変更する。
    # `保存` ボタンは、編集中のテキストを編集セルに書き込む。
    # `次` ボタンは、不一致セルの検索結果リストを使って、不一致セルを順に編集する。
    # `↓` `↑` `←` `→` ボタンは、隣接するセルを編集する。
    # `閉じる` ボタンは、フォームを閉じる。
    # `隠す` ボタンは、フォームを非表示にする。（編集を継続したまま、一時的にエクセル本体を表示する。）
    # すべてのボタンで、 Alt キーによるショートカットが利用できる。
 # フォームのサイズと移動
    # フォームはエクセル本体と同じサイズで開き、開いた後はサイズ変更できない。
    # フォームは自由に移動できる。最初はエクセル本体にかぶせて開くが、移動すれば、その場所を記憶する。
    # フォームは常に前面表示されるが、移動させれば開いたままでもエクセルの操作ができる。
 # その他の機能
    # 隠したフォームを再表示するには、ツールバーの `入力` ボタンを押す。
    # ツールバーの `解除` ボタンを押すと、すべての設定を消去しフォームを閉じる。
 

= Snapshots =

 * エクセル2007 ではリボンのアドインタブにボタンを表示する。
    http://4.bp.blogspot.com/-qWcfzFYPLQ8/TZfrm4n318I/AAAAAAAAAEc/Lzc-ZnyFet0/s1600/shot6.png

* エクセル2000 ではツールバーを表示する。
    http://4.bp.blogspot.com/-ZWRa3yS9hkE/TZfrksvJYoI/AAAAAAAAAEI/28brFTHPglU/s1600/shot1.png

* ツールバーの比較結果から、不一致セルにジャンプする。
    http://3.bp.blogspot.com/-ciZj2nVkjrI/TZfrlYZJniI/AAAAAAAAAEQ/VrwSWRDbi-k/s1600/shot3.png

* フォームで比較しながら編集する。
    http://3.bp.blogspot.com/-YlJiwRP5b0c/TZfrkxoq4mI/AAAAAAAAAEM/P1aabjFuJy4/s1600/shot2.png

* エクセル本体と並べると、このようにシートと連携している。
    http://2.bp.blogspot.com/-_Fh5CI9X3FA/TZfrlz0hNvI/AAAAAAAAAEU/nvWM3q3V4mU/s800/shot4.png

* 編集だけのときは、フォーム全体を広く使う。
    http://3.bp.blogspot.com/-woINKXEhoUc/TZfrmXU4tsI/AAAAAAAAAEY/JjT3_RlIdhU/s800/shot5.png


= Code =

{{{
}}}
