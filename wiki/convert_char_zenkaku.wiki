#summary convert characters between hankaku and zenkaku in excel cells
#labels Phase-Requirements,Phase-Design,Phase-Deploy

<wiki:toc max_depth="3" />

= Introduction =

 * convert characters between hankaku and zenkaku in excel cells
 * work as an addin

== 概要 ==
 * エクセルでセル文字列を半角または全角に変換する
 * アドインとして動く

= Details =

== 説明 ==
 * アドインを有効にすると、操作用のボタンがツールバー（リボン）に追加される。
    * 全角へ、ｶﾅ全、数全、英全、半角へ、ｶﾅ半、数半、英半
 * ボタンを押すと、それぞれの文字種への変換を行う。
    # 全角へ、半角へ、のボタンはすべてを変換。
    # カタカナは、カタカナと関連する記号
    # 数字は、0から9まで
    # 英字は、アルファベットと関連する記号
 * 変換の範囲は、選択したセル範囲、選択した列、選択した行など。
 * 変換による副作用。
    # 選択した範囲は、すべて文字列として変換を行う。
    # 数値、日付、数式が入っていた場合も、そのまま文字列として変換対象にする。
      * たとえば =Sum(A1:B1) が入っていた場合、この式そのものを文字として全角文字 ＝Ｓｕｍ（Ａ１：Ｂ１） に変換する。
    # 選択した範囲のセル書式の表示形式（日付や数値桁などの表現）を、すべて `標準` にする。
      * たとえば日付データ 2011/4/4 15:50 が入っていて、表示形式で ４月４日（月）になっていた場合、これを英字全角変換すると、 2011／4／4 15：50 という文字になる。

= Downloads =

 * [http://code.google.com/p/cowares-excel-hello/downloads/list?can=2&q=convert_char_zenkaku downloads / ダウンロード]

= How to use =


== 使い方 ==
 * アドインのインストールと有効化
    # アドインファイルを、アドイン用フォルダにコピーする。
      * アドインの設定画面で、参照ボタンを押したときに表示されるフォルダなど、アドイン用に信頼した場所を使う。
    # アドインの設定画面で、「全角半角変換」にチェックを入れて、有効化する。
      * 一覧に表示されない場合、参照ボタンで読み込む。
      * 有効化しておけば、エクセル起動だけでアドインが自動で読み込まれる。
      * http://1.bp.blogspot.com/-IKIU0wRY5j4/TZ_QpcEGJTI/AAAAAAAAAEw/__X7C-dGPTw/s1600/shot3.png
    # アンインストール
      * 上記の逆手順、アドインの無効化、アドインファイルの削除、を行う。
      * 追加修正のバージョンをインストールするとき、同じファイル名で上書きするのでなければ、先に古いバージョンをアンインストールしないといけない。
 * 基本的な使い方
    # 変換対象のブックで、変換したい範囲を選ぶ。列、行、セル範囲、シート全体など。
      * Ctrl キーを使って、複数箇所を選んでもよい。
      * 何も選ばないと、カーソルのあるセル１つだけを変換する。
    # 変換したいキーを押す。
      * 正常動作すればメッセージなどは出ず、通常は一瞬で処理が終わる。
 * もっと詳しい情報
    # 非対称なカナ変換
      * カナ変換では、全角への変換と半角への変換対象が異なるため、行きと帰りで処理が異なる。
      * 半角カナを全角に変換する場合、カナ記号はすべて全角に変換。
      * 片仮名の全角カナを半角に変換する場合、カナ記号はひらがなや漢字として扱うため変換せず、片仮名だけを半角に変換する。
      * カナ長音 `ー` は、直前の文字に応じて変換する。
    # スペースの変換
      * 半角、全角のスペースは、文字種類によらない変換のときのみ、変換対象となる。
        * 全角へ、半角へ、のボタン　 －－－ 　スペースを変化させる。
        * それ以外のボタン　　　　　　 －－－ 　スペースを変化させない。
    # 数式の扱い
      * セル数式の扱いを指定できる。
        # 式文字：　数式を文字として扱い、変換対象とする。
        # 式無視：　数式セルは変換しない。
        # 値固定：　数式の計算結果を文字として扱い、変換対象とする。

=== 2011/4/13 の修正 ===

 # 全角カナ長音 `ー` を、直前の文字に応じて変換する。
    * `ｶﾅ半` → 直前の文字が、全角カナの場合のみ、半角カナ長音 `ｰ` に変換する。
    * `半角へ` → 直前の文字が、全角英数カナスペースの場合のみ、半角カナ長音 `ｰ` に変換する。
    * 上記いずれも、そのボタンが変換対象とする文字に続いて現れた長音を変換する。
 # 全角ハイフン `－` と半角ハイフン `-` を、直前の文字に応じて変換する。
    * `数半` → 直前の文字が、全角数字の場合のみ、半角ハイフン `-` に変換する。
    * `数全` → 直前の文字が、半角数字の場合のみ、全角ハイフン `－` に変換する。
    * `半角へ` `全角へ` `英半` および `英全` ボタンでは、既に、ハイフンの変換は行われており、その動作は変更しない。


= Snapshots =

 * エクセル2007 ではリボンのアドインタブにボタンを表示する。
    http://2.bp.blogspot.com/-CesX5NTgjOs/TZ_QofQspzI/AAAAAAAAAEo/cEl4tcQA4Zc/s1600/shot1.png

 * セル数式の扱いを指定する。
    http://2.bp.blogspot.com/-n63FTS-IhQU/TZ_Qo9CZCcI/AAAAAAAAAEs/eTQXfGHlPCo/s1600/shot2.png

 * アドインの設定画面で有効にする。
    http://1.bp.blogspot.com/-IKIU0wRY5j4/TZ_QpcEGJTI/AAAAAAAAAEw/__X7C-dGPTw/s1600/shot3.png



= Code =

{{{
}}}
