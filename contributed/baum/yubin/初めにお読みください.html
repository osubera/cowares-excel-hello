<?xml version="1.0" encoding="Shift_JIS"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML Basic 1.1//EN" "http://www.w3.org/TR/xhtml-basic/xhtml-basic11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja">
<head>
<title>初めにお読みください -  ● 郵便番号検索</title>
<link rel="stylesheet" href="std.css" type="text/css" />
<link rel="copyright" href="http://kobobau.com/copy.html" />
</head>
<body>
<div class="productid"> ● 郵便番号検索 yubin</div>
<h1>初めにお読みください</h1>

<h2 onclick="smr1(this)">このソフトにできること</h2>
<div class="tree">

<p>
日本の郵便番号を検索する。
</p>

<p>
住所から郵便番号、郵便番号から住所を検索するソフトです。
起動も検索も早く、操作も単純で実用的。
誰でも簡単に使える通常の検索画面だけでなく、業務利用者向けのエキスパートモード、自動処理向けのコマンドモード、バックグラウンドタスク向けのバッチモードと、４つのモードを切り替えて使えます。
全国版として使うだけでなく、地域限定による軽い操作環境で使うこともできます。
性能が低いパソコンでもストレス無く使えます。
VBScript だけで書かれているので、ほとんどのウィンドウズ環境でそのまま動きます。
ライセンスがフリーなので、好き勝手にカスタマイズできます。
</p>

<p>
郵便番号データはパッケージに含まれていません。
別途、 <a href="http://www.post.japanpost.jp/zipcode/download.html">日本郵便</a> のページからダウンロードして、データを初期化する必要があります。
初期化ツールもパッケージに含まれているため、簡単に取り込めます。
</p>

</div>
<h2 onclick="smr1(this)">以下に同意した上でご使用ください</h2>
<div class="tree">

<div>
<h3>
1. 保証はありません。 (自律)
</h3>
<p>
既知の欠陥も未知の欠陥も含めたまま公開されています。 
品質や正確さはご自身で判断してください。 
使用により生じた損失など、すべての責任はあなたが負います。
</p>
</div>

<div>
<h3>
2. フリーです。 (自由)
</h3>
<p>
どなたでも目的によらず無料で無期限に使えます。 
登録や承諾は不要です。 
商用も可です。
自由な加工を含む再利用も再配布もできます。
</p>
</div>

<div>
<h3>
3. 公正であれ。 (公正)
</h3>
<p>
オリジナルが、あなたの作品と無関係に利用できることを明示する。 
オリジナルの仕事とあなたの仕事を、正直に区別する。 
オリジナルの著作権とライセンスを尊重する。
</p>
</div>

<div>
<span>
コ・ウェア・ライセンス（自律、自由、公正）の詳細は <a href="http://cowares.nobody.jp/license/">http://cowares.nobody.jp/license/</a> で公開されています。
</span>
</div>

</div>
<h2 onclick="smr1(this)">動作環境</h2>
<div class="tree">

<ul>
<li>Windows 95 以降すべて。</li>
<li>Windows 2000 以前の場合、以下のコンポーネントが無ければ、 <a href="http://www.microsoft.com/downloads/ja-jp/default.aspx">マイクロソフトのページからダウンロード</a> して追加してください。
<ul><li>Windows Scripting Host</li><li>MDAC 2.1以上</li><li>Jet OLEDB 4.0</li></ul></li>
</ul>

</div>
<h2 onclick="smr1(this)">配布しているファイルについて</h2>
<div class="tree">

<ol>
<li>ZIP形式で圧縮しています。 Windows 2000 以前では、この形式を解凍できるソフトウェアが別途必要です。</li>
<li>圧縮ファイルには以下のファイルが含まれます。
 <table>
 <tr><th>yubin.vbs</th><td>検索ソフトウェア本体。</td></tr>
 <tr><th>yubin.vbs.mdb</th><td>郵便番号データを格納するデータベースファイル。</td></tr>
 <tr><th>new_yubin.vbs</th><td>データ初期化ツール。</td></tr>
 <tr><th>httpgets.vbs</th><td>バッチダウンロードツール。</td></tr>
 <tr><th>urls.txt</th><td>バッチダウンロードに使える URL リスト。（全国一括と事業所）</td></tr>
 <tr><th>urls_ken.txt</th><td>バッチダウンロードに使える URL リスト。（県別）</td></tr>
 <tr><th>yubin_kagawa.bat</th><td>地域限定版にするときのバッチ見本。</td></tr>
 <tr><th>ライセンス.txt</th><td>このソフトウェアのライセンスです。</td></tr>
 <tr><th>初めにお読みください.html</th><td>この解説書です。</td></tr>
 <tr><th>その他</th><td>解説書の使う画像ファイルなど。</td></tr>
 </table>
</li>
</ol>

</div>
<h2 onclick="smr1(this)">郵便番号データのダウンロードとデータ初期化</h2>
<div class="tree">

<ol>
<li>郵便番号データをダウンロードする。
<ol>
<li>郵便番号データは、 <a href="http://www.post.japanpost.jp/zipcode/download.html">日本郵便</a> のページからダウンロードします。</li>
<li>使用するデータは、次の２つです。
<ul><li><a href="http://www.post.japanpost.jp/zipcode/dl/oogaki-zip.html">促音・拗音を小書きで表記しないもの</a></li>
<li><a href="http://www.post.japanpost.jp/zipcode/dl/jigyosyo/index-zip.html">事業所の個別郵便番号</a></li></ul>
</li>
<li>通常は全国版と事業所の２つを使います。</li>
<li>検索したい都道府県が限られている場合、県別データを使用してファイルを小さくすることができます。</li>
<li>事業所データは、不要なら入れなくても動作します。</li>
<li>上記 URL でブラウザからダウンロードする以外に、付属ツールで直接ダウンロードしても構いません。
<ol>
<li>ダウンロードするディレクトリで、コマンドプロンプトを開く。</li>
<li>そこに、付属の httpgets.vbs urls.txt urls_ken.txt をコピーしておく。</li>
<li>全国版なら、 CScript httpgets.vbs &lt; urls.txt としてダウンロードする。</li>
</ol>
</li>
<li>ダウンロードしたファイルは ZIP アーカイブです。データ初期化前に、解凍して中の CSV ファイルを取り出してください。</li>
</ol>
</li>
<li>データ初期化をする。
<ol>
<li>初期化が終わると、 yubin.vbs.mdb ファイルのサイズが、 35M バイト程度になります。そのつもりで先に配置場所を決めておくと効率が良いです。</li>
<li>yubin.vbs.mdb yubin.vbs new_yubin.vbs は同じフォルダに配置する必要があります。</li>
<li>ダウンロードして解凍した CSV ファイルを全部掴み、 new_yubin.vbs にドラッグアンドドロップすると初期化が始まります。
<br/><img src="img/shot1.png" alt="" />
CSV のアイコンは、この絵と異なる場合もあります。
</li>
<li>次のダイアログが出れば終了です。
<br/><img src="img/shot3.png" alt="" />
</li>
<li>初期化は CPU パワーを強く消費します。
<ul>
<li>初期化中はパソコンの操作が極めて遅くなる場合があります。</li>
<li>重要な作業との並行は避けてください。</li>
<li>CPUが非力なパソコンでは時間がかかります。
<ul><li>2G 2コア程度で 30秒</li><li>1G で 4分</li><li>433M で 8分</li></ul>
</li>
</ul>
<img src="img/shot18.png" alt="CPU使用量 100%" />
</li>
<li>コマンドプロンプトでも動作するので、バッチファイルで更新することも可能です。
<pre>
C:\tmp>cscript //nologo new_yubin.vbs ken_all.csv jigyosyo.csv
市町村郵便番号の更新: ken_all.csv
大口事業所の更新: jigyosyo.csv
</pre>
</li>
</ol>
</li>
<li>データの更新。
<ol>
<li>このソフトは差分データには対応しません。</li>
<li>データ更新の際は、最初のアーカイブに戻って、まっさらのデータベースに新しくダウンロードした郵便番号データを追加してください。</li>
</ol>
</li>
</ol>

</div>
<h2 onclick="smr1(this)">ご使用の手引き - とりあえず使ってみる</h2>
<div class="tree">

<ol>
<li>初期化していなければ使えません</li>
<li>yubin.vbs のアイコンをダブルクリック<br/>
<img src="img/shot6.png" alt="ブランク" />
</li>
<li>香川県　高松市　屋島</li>
<li>上記を打ち込んで OK を押す<br/>
<img src="img/shot10.png" alt="香川県　高松市　屋島" />
</li>
<li>7610113</li>
<li>上記を打ち込んで OK を押す<br/>
<img src="img/shot13.png" alt="7610113" />
</li>
<li>キャンセルを押して終了</li>
<li>OKボタンとキャンセルボタンの代わりに、エンターキーとエスケープキーが使えます。</li>
</ol>

</div>
<h2 onclick="smr1(this)">ご使用の手引き - 詳しく知りたい - 検索ルール</h2>
<div class="tree">

<ol>
<li>どのモードでも、１行のテキストで検索を指示します。そのルールは共通です。</li>
<li>ワード
<ul>
<li>検索語は、スペースで複数に区切ります。その単位をワード（語）と呼びます。</li>
<li>先頭のワードによって、何が指定されたかを自動的に判断します。（番号なのか住所なのか）</li>
<li>住所から検索する場合、都道府県名、市などの名称、町などの名称、の順に３ワードを指定します。郵便事業による区切りのため、正確な行政区分ではありません。</li>
<li>県、市と２ワード目までは正確に入れる必要があります。</li>
<li>町など３ワード目は、前方一致検索を行うため、途中まで入れれば該当する一覧を出します。</li>
<li>都道府県名だけで検索すると、２ワード目の一覧が出ます。<br/>
<img src="img/shot8.png" alt="都道府県名だけ入れると市の一覧" />
</li>
</ul>
</li>
<li>文字種
<ul>
<li>漢字とひらがなが使えます。<br/>
<img src="img/shot12.png" alt="香川県　高松市　やしま" />
<img src="img/shot17.png" alt="＄　かがわけん　さぬきし　しやくしょ" />
</li>
<li>カタカナや半角カナもつかえますが、拗音の自動修正には対応していないため、ひらがなによる検索と微妙に違うときがあります。<br/>
<img src="img/shot25.png" alt="じようとう" />
</li>
</ul>
</li>
<li>数字
<ul>
<li>先頭ワードが数字で始まるときは郵便番号からの検索を行います。</li>
<li>先頭３桁が必須で、４桁目以下を省略した場合、該当範囲の一覧を表示します。<br/>
<img src="img/shot15.png" alt="761-01" />
</li>
<li>数字は全角でも半角でも良く、間にハイフンが入ってもなくても構いません。<br/>
<img src="img/shot13.png" alt="7610113" />
<img src="img/shot14.png" alt="761-0113" />
</li>
<li>住所と事業所を同時には見ないため、次のように、769-21 の検索結果に 769-219xx が含まれないといったこともあります。<br/>
<img src="img/shot19.png" alt="769-21" />
<img src="img/shot20.png" alt="769-219" />
</li>
</ul>
</li>
<li>特殊ワード
<ul>
<li><b>＄</b> または <b>$</b> を先頭ワードにすると、事業所検索になります。県、市、事業所名の順に指定します。事業所名は部分一致検索です。<br/>
<img src="img/shot16.png" alt="＄を入れて事業所検索" />
</li>
<li><b>県</b> または <b>けん</b> を先頭ワードにすると、都道府県一覧を表示します。<br/>
<img src="img/shot7.png" alt="県を入れて都道府県一覧" />
</li>
</ul>
</li>
</ol>


</div>
<h2 onclick="smr1(this)">ご使用の手引き - 詳しく知りたい - 見つからないときの表示</h2>
<div class="tree">

<ol>
<li>住所からの検索で、都道府県名と市などの名称までの２ワードだけを入れると、　※　表示をします。このとき表示された郵便番号は台帳で「以下に掲載がない場合」と書かれている番号で、いわゆる「その他」扱いの郵便番号です。<br/>
<img src="img/shot9.png" alt="２ワードまで入れると、※表示" />
</li>
<li>町など３ワード目に指定したものが見つからないときも　※　表示です。ちなみに下の例は、漢字「嶋」を間違えたため検索できていません。<br/>
<img src="img/shot11.png" alt="香川県　高松市　屋嶋　は漢字が違う" />
</li>
<li>存在しない県や市を指定したときは、何も表示しません。<br/>
<img src="img/shot21.png" alt="さぬき県　さぬき市　など無い" />
</li>
</ol>

</div>
<h2 onclick="smr1(this)">ご使用の手引き - 詳しく知りたい - 地域限定</h2>
<div class="tree">

<ol>
<li>県や市をあらかじめ固定して、決まった県内や市内の郵便番号検索だけを行うことができます。<br/>
<img src="img/shot22.png" alt="香川県高松市専用" /></li>
<li>次のように、環境変数を設定して地域限定にします。バッチファイルを用意すると便利です。県専用のときは KENKOTEI だけ、市専用のときは、KENKOTEI と SHIKOTEI の両方をセットします。
<pre>
SET KENKOTEI=香川県
SET SHIKOTEI=高松市
</pre>
</li>
<li>複数のバッチファイルを用意すれば、１つのソフトだけで、香川県専用と高松市専用というように使い分けることもできます。</li>
<li>地域限定機能は、住所による検索と事業所の検索に共通です。<br/>
<img src="img/shot23.png" alt="地域限定で事業所を探す" /></li>
<li>入力が少なくなり、素早く検索できます。市まで限定していれば、ひらがな１文字程度で必要なものを探せます。<br/>
<img src="img/shot26.png" alt="地域限定のエキスパートモード" /></li>
</ol>

</div>
<h2 onclick="smr1(this)">ご使用の手引き - 詳しく知りたい - ４つのモード</h2>
<div class="tree">

<ol>
<li>通常モード
<ul>
<li>見慣れたウィンドウアプリケーションで、誰でも使いやすい形です。</li>
<li><img src="img/shot10.png" alt="香川県　高松市　屋島" /></li>
<li>結果表示画面と入力画面が同じなので、何度でも続けて検索を行えます。</li>
<li>常に画面上の定位置に出ます。表示位置はスクリプトの次の個所で決めています。
<pre>
Const PopX = 500    ' x location by screen twips
Const PopY = 1000   ' y location by screen twips
</pre>
</li>
</ul>
</li>
<li>エキスパートモード
<ul>
<li>通常モードと動作は同じですが、コマンドプロンプト内で動作します。</li>
<li><img src="img/shot24.png" alt="expert mode" /></li>
<li>ソフトを置いたフォルダで、コマンドプロンプトを開きます。</li>
<li>CScript yubin.vbs と打つと入力待ちになります。</li>
<li>入力モードが固定できるので、続けて検索する際の効率が上がります。</li>
<li>何も入力せず、エンターを押すと終了します。</li>
</ul>
</li>
<li>コマンドモード
<ul>
<li>コマンド引数から検索ワードを取り込み、検索結果を標準出力に出し、すぐに終了します。</li>
<li>CScript //NoLogo yubin.vbs 香川県 高松市 末広町</li>
</ul>
</li>
<li>バッチモード
<ul>
<li>標準入力から検索ワードを取り込み、検索結果を標準出力に出します。</li>
<li>CScript //B yubin.vbs &lt; in.txt &gt; out.txt</li>
<li>入力の例
<pre>
760000
760-0005
769-9999
香川県
かがわけん　高松市
香川県　たかまつし　西
</pre>
</li>
<li>出力の例
<pre>
&lt;760000
7600000 香川県 高松市 以下に掲載がない場合
7600001 香川県 高松市 新北町
7600002 香川県 高松市 茜町
7600003 香川県 高松市 西町
7600004 香川県 高松市 西宝町
7600005 香川県 高松市 宮脇町
7600006 香川県 高松市 亀岡町
7600007 香川県 高松市 中央町
7600008 香川県 高松市 中野町
7600009 香川県 高松市 峰山町

&lt;760-0005
7600005 香川県 高松市 宮脇町

&lt;769-9999

&lt;香川県
高松市 丸亀市 坂出市 善通寺市 
観音寺市 さぬき市 東かがわ市 三豊市 
小豆郡土庄町 小豆郡小豆島町 
木田郡三木町 香川郡直島町 
綾歌郡宇多津町 綾歌郡綾川町 
仲多度郡琴平町 仲多度郡多度津町 
仲多度郡まんのう町 
&lt;かがわけん　高松市
7600000 香川県 高松市 ※

&lt;香川県　たかまつし　西
7600003 香川県 高松市 西町
7600004 香川県 高松市 西宝町
7600021 香川県 高松市 西の丸町
7600022 香川県 高松市 西内町
7610445 香川県 高松市 西植田町
7618045 香川県 高松市 西山崎町
7618051 香川県 高松市 西春日町
7618053 香川県 高松市 西ハゼ町

</pre>
</li>
</ul>
</li>
</ol>

</div>
<h2 onclick="smr1(this)">うまく初期化できないとき</h2>
<div class="tree">

<ol>
<li>次のエラーなら、yubin.vbs.mdb ファイルを new_yubin.vbs と同じフォルダに置く。
<br/>
<img src="img/shot5.png" alt="" />
</li>
<li>次のエラーなら、ダウンロードしたファイルを解凍し、 CSV 形式になったファイルをドロップする。
<br/>
<img src="img/shot4.png" alt="" />
</li>
<li>次のエラーなら、初期化前の yubin.vbs.mdb をアーカイブから取り出してやり直す。
<br/>
<img src="img/shot2.png" alt="" />
</li>
</ol>

</div>
<h2 onclick="smr1(this)">社内SEや開発者の方、２次配布を考えている方へ</h2>
<div class="tree">

<ol>
<li>本ソフトは、 Microsoft Access を持っていないユーザーによる初期化を想定し、 compress を行っていません。</li>
<li>初期化時だけ必要なクエリーや、中間生成物のテーブルを削除していないため、mdb には無駄な空間が残っています。</li>
<li>Access が利用可能なパソコンなら、必要なテーブルだけをエクスポートするなり、不要品を削除して圧縮するなりすることで、 mdb ファイルのサイズを 12M 程度にまで圧縮できます。</li>
<li>初期化済み mdb の２次配布を考えているなら、ファイルサイズの圧縮を検討してみてください。</li>
<li>検索に必要なテーブルは次の４つです。
<ul>
<li>ken</li>
<li>shi</li>
<li>cho</li>
<li>jigyo</li>
</ul>
</li>
</ol>

</div>
<h2 onclick="smr1(this)">連絡先</h2>
<div class="tree">

<p>動作報告、不動作報告、要望などは、<a href="http://cowares.blogspot.com/search/label/baum">ブログ</a>にコメントしてください。</p>

<table>
<tr><th>作者</th><td>Tomizono (工房ばう)</td></tr>
<tr><th>メール</th><td><a href="mailto:cowares@gmail.com">cowares@gmail.com</a></td></tr>
<tr><th>ブログ</th><td><a href="http://cowares.blogspot.com/">http://cowares.blogspot.com</a></td></tr>
<tr><th>ホームページ</th><td><a href="http://kobobau.com/xls/">http://kobobau.com/xls/</a></td></tr>
<tr><th>ダウンロード</th><td><a href="http://www.vector.co.jp/vpack/browse/person/an030389.html">http://www.vector.co.jp</a></td></tr>
<tr><th>オープンソース</th><td><a href="http://code.google.com/p/cowares-excel-hello/downloads/list?can=2&q=baum">オリジナルソースは cowares-excel-hello プロジェクトが配布しています。</a></td></tr>
</table>

</div>
<div class="pr">
<h2 onclick="smr1(this)">低価格のシステム開発</h2>
<div class="tree">

<p>エクセルブック、ワード、アクセスのカスタムメイドやウェブシステムの開発などをリーズナブルな価格で承っております。</p>

<div class="shop">
<h3>
そのマクロ、部下が１時間残業して作ってませんか？
</h3>
<div class="cell">
<h4>
あなたの部下は時給1,000円以下ですか？
</h4>
<ul>
<li>
エクセル、アクセスのデータ、マクロが1,000円から発注できます。
</li>
<li>
使用制限の無いオープンで安心なコ・ウェア・ライセンス。
</li>
<li>
コ・ウェアなら、部下に命令するより安上がりです。
</li>
</ul>
</div>
</div>

<div class="shop">
<h3>
業者との会議に10万円以上の人件費が飛んでませんか？
</h3>
<div class="cell">
<h4>
仕様の決定に過大な時間とコストをかけていませんか？
</h4>
<ul>
<li>
その費用で、たたき台となるプロトタイプを作れます。
</li>
<li>
初号機に不満が無ければ、そのまま完成品として現場に投入できます。
</li>
<li>
完全オープンなコードなので、続きを別の業者に発注してもよいのです。
</li>
<li>
コ・ウェアなら、大きな失敗を防げます。
</li>
</ul>
</div>
</div>

<div class="compact">

<ul class="sectionlist">
<li>導入する利点</li>
<li><a href="http://cowares.nobody.jp/ja/shop/business.html">事業者で</a></li>
<li><a href="http://cowares.nobody.jp/ja/shop/enterprise.html">大企業で</a></li>
<li><a href="http://cowares.nobody.jp/ja/shop/public.html">公益法人で</a></li>
<li><a href="http://cowares.nobody.jp/ja/shop/personal.html">個人で</a></li>
<li><a href="http://cowares.nobody.jp/ja/shop/it.html">IT企業で</a></li>
</ul>

<ul class="sectionlist">
<li>発注について</li>
<li><a href="http://cowares.nobody.jp/ja/shop/service.html">発注から公開まで</a></li>
<li><a href="http://cowares.nobody.jp/ja/shop/price.html">料金</a></li>
<li><a href="http://cowares.nobody.jp/ja/shop/publish.html">公開（納品）</a></li>
<li><a href="http://cowares.nobody.jp/ja/shop/must.html">基本的なルール</a></li>
<li><a href="http://cowares.nobody.jp/ja/shop/may.html">細かいルール</a></li>
<li><a href="http://cowares.nobody.jp/ja/shop/why.html">なぜ無料ソフトを買う？</a></li>
</ul>

<ul class="sectionlist">
<li><a href="http://cowares.nobody.jp/ja/shop/policy.html">プライバシー</a></li>
<li><a href="http://cowares.nobody.jp/ja/shop/contract.html">取引上の注意</a></li>
</ul>

<div class="sectionlistr">
<a href="http://cowares.nobody.jp/ja/shop/order.html"><img src="shop.png" alt="http://cowares.nobody.jp/ja/shop/order.html" /></a>
</div>

</div>
<div class="compact">

<ul class="sectionlist">
<li><a href="http://cowares.nobody.jp/ja/shop/order.html">すぐに注文する</a></li>
</ul>

</div>

<div class="compact">
</div>

</div>
</div>

<div class="copyright"><a href="http://kobobau.com/copy.html">Copyright (c) 2011 Tomizono - kobobau.com</a></div>

<div class="lastupdate">2011.2.8 更新</div>

<script type="text/javascript" src="vba2.js"></script>
</body>
</html>
